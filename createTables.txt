CREATE TABLE CLIENTES (
    CPF VARCHAR2(14),
    NOME VARCHAR2(20) NOT NULL,
    CONTATO VARCHAR2(13) NOT NULL,
    
    CONSTRAINT PK_CLI PRIMARY KEY (CPF),
    CONSTRAINT CK_CLI_CON CHECK(REGEXP_LIKE(CONTATO, '[0-9]{2}\-[0-9]{5}\-[0-9]{4}')),
    CONSTRAINT CK_CLI_CPF CHECK(REGEXP_LIKE(CPF, '[0-9]{3}\.[0-9]{3}\.[0-9]{3}\-[0-9]{2}'))
);

CREATE TABLE FESTAS (
    DATA_HORA DATE,
    LOCAL VARCHAR2(20),
    CLIENTE VARCHAR2(14) NOT NULL,
    TIPO VARCHAR2(9) NOT NULL,
    CASAMENTO_LOCAL_CERIMONIAL VARCHAR2(20),
    
    CONSTRAINT PK_FES PRIMARY KEY (DATA_HORA, LOCAL),
    CONSTRAINT FK_FES_CLI FOREIGN KEY (CLIENTE) REFERENCES CLIENTES(CPF) ON DELETE CASCADE,
    CONSTRAINT CK_FES_TIP CHECK(UPPER(TIPO) IN('CASAMENTO', 'INFANTIL'))
);

CREATE TABLE CRONOGRAMA (
    DATA_HORA DATE,
    LOCAL VARCHAR2(20),
    ATIVIDADE VARCHAR2(20) NOT NULL,
    HORARIO DATE,
    
    CONSTRAINT PK_CRO PRIMARY KEY (DATA_HORA, LOCAL),
    CONSTRAINT FK_CRO_DH FOREIGN KEY (DATA_HORA, LOCAL) REFERENCES FESTAS(DATA_HORA, LOCAL) ON DELETE CASCADE
);
 
CREATE TABLE JOGOS (
    NOME VARCHAR2(20),
    NRO_JOGADORES INTEGER,
    TIPO VARCHAR2(10) NOT NULL,
    GASTO_ENERGIA INTEGER,
    
    CONSTRAINT PK_JOG PRIMARY KEY (NOME),
    CONSTRAINT CK_JOG_TIP CHECK(UPPER(TIPO) IN('ELETRÃ”NICO', 'TABULEIRO', 'CARTAS'))
);

CREATE TABLE ESTILOS (
    NOME VARCHAR2(20),
    
    CONSTRAINT PK_EST PRIMARY KEY (NOME)
);

CREATE TABLE JOGOS_ESTILOS (
    JOGO VARCHAR2(20),
    ESTILO VARCHAR2(20),
    
    CONSTRAINT PK_JE PRIMARY KEY (JOGO, ESTILO),
    CONSTRAINT FK_JE_JOG FOREIGN KEY (JOGO) REFERENCES JOGOS(NOME) ON DELETE CASCADE,
    CONSTRAINT FK_JE_EST FOREIGN KEY (ESTILO) REFERENCES ESTILOS(NOME) ON DELETE CASCADE
);

CREATE TABLE FESTA_JOGOS (
    DATA_HORA DATE,
    LOCAL VARCHAR2(20),    
    JOGO VARCHAR2(20),
    
    CONSTRAINT PK_FJ PRIMARY KEY (DATA_HORA, LOCAL, JOGO),
    CONSTRAINT FK_FJ_JOG FOREIGN KEY (JOGO) REFERENCES JOGOS(NOME) ON DELETE CASCADE,
    CONSTRAINT FK_FJ_DAT FOREIGN KEY (DATA_HORA, LOCAL) REFERENCES FESTAS(DATA_HORA, LOCAL) ON DELETE CASCADE
);

CREATE TABLE FOGOS_ARTIFICIOS (
    MODELO VARCHAR2(10),
    FABRICANTE VARCHAR2(10),
    PRECO FLOAT,
    QUANTIDADE INTEGER,
    
    CONSTRAINT PK_FA PRIMARY KEY (MODELO, FABRICANTE)
);

CREATE TABLE SHOW_FOGOS (
    TIPO_SHOW VARCHAR2(20),
    DURACAO TIMESTAMP,
    CUSTO FLOAT,
    PER_SEGURANCA INTEGER,
    
    CONSTRAINT PK_SF PRIMARY KEY (TIPO_SHOW)
);

CREATE TABLE ARTIFICIOS_SHOW (
    SHOW VARCHAR2(20),
    MOD_FOGOS VARCHAR2(10),
    FAB_FOGOS VARCHAR2(10),
    
    CONSTRAINT PK_AS PRIMARY KEY (SHOW, MOD_FOGOS, FAB_FOGOS),
    CONSTRAINT FK_AS_SHO FOREIGN KEY (SHOW) REFERENCES SHOW_FOGOS(TIPO_SHOW) ON DELETE CASCADE,
    CONSTRAINT FK_AS_FOG FOREIGN KEY (MOD_FOGOS, FAB_FOGOS) REFERENCES FOGOS_ARTIFICIOS (MODELO, FABRICANTE) ON DELETE CASCADE
);

CREATE TABLE TECNICOS (
    CPF VARCHAR2(14),
    NOME VARCHAR2(20) NOT NULL,
    CONTATO VARCHAR2(13),
    VALOR FLOAT,
    
    CONSTRAINT PK_TEC PRIMARY KEY (CPF),
    CONSTRAINT CK_TEC_CON CHECK(REGEXP_LIKE(CONTATO, '[0-9]{2}\-[0-9]{5}\-[0-9]{4}')),
    CONSTRAINT CK_TEC_CPF CHECK(REGEXP_LIKE(CPF, '[0-9]{3}\.[0-9]{3}\.[0-9]{3}\-[0-9]{2}'))
);

CREATE TABLE REALIZACAO (
    TECNICO VARCHAR2(14) NOT NULL,
    DATA_HORA DATE,
    LOCAL VARCHAR2(20),
    SHOW VARCHAR2(20),
    
    CONSTRAINT PK_REA PRIMARY KEY (TECNICO, DATA_HORA, LOCAL, SHOW),
    CONSTRAINT FK_REA_TEC FOREIGN KEY (TECNICO) REFERENCES TECNICOS(CPF) ON DELETE CASCADE,
    CONSTRAINT FK_REA_SHO FOREIGN KEY (SHOW) REFERENCES SHOW_FOGOS(TIPO_SHOW) ON DELETE CASCADE,
    CONSTRAINT FK_REA_DAT FOREIGN KEY (DATA_HORA, LOCAL) REFERENCES FESTAS(DATA_HORA, LOCAL) ON DELETE CASCADE
);

CREATE TABLE FOTOGRAFOS (
    CPF VARCHAR2(14),
    NOME VARCHAR2(20) NOT NULL,
    CONTATO VARCHAR2(13),
    VALOR FLOAT,
    
    CONSTRAINT PK_FOT PRIMARY KEY (CPF),
    CONSTRAINT CK_FOT_CON CHECK(REGEXP_LIKE(CONTATO, '[0-9]{2}\-[0-9]{5}\-[0-9]{4}')),
    CONSTRAINT CK_FOT_CPF CHECK(REGEXP_LIKE(CPF, '[0-9]{3}\.[0-9]{3}\.[0-9]{3}\-[0-9]{2}'))
);

CREATE TABLE ALBUM (
    DATA_HORA_FESTA DATE,
    LOCAL_FESTA VARCHAR2(20),
    MODELO VARCHAR(20),
    LIM_FOTOS INTEGER,
    PRECO FLOAT,
    
    CONSTRAINT PK_ALB PRIMARY KEY (DATA_HORA_FESTA, LOCAL_FESTA),
    CONSTRAINT FK_ALB FOREIGN KEY (DATA_HORA_FESTA, LOCAL_FESTA) REFERENCES FESTAS(DATA_HORA, LOCAL) ON DELETE CASCADE
);

CREATE TABLE FOTOS (
    DATA_HORA_FESTA DATE,
    LOCAL_FESTA VARCHAR2(20),
    DATA_HORA_FOTO DATE,
    FOTOGRAFO VARCHAR2(14),
    
    CONSTRAINT PK_FOT PRIMARY KEY (DATA_HORA_FESTA, LOCAL_FESTA, DATA_HORA_FOTO, FOTOGRAFO),
    CONSTRAINT FK_FOT_DAT FOREIGN KEY (DATA_HORA_FESTA, LOCAL_FESTA) REFERENCES ALBUM(DATA_HORA_FESTA, LOCAL_FESTA) ON DELETE CASCADE,
    CONSTRAINT FK_FOT_FOT FOREIGN KEY (FOTOGRAFO) REFERENCES FOTOGRAFOS(CPF) ON DELETE CASCADE
);

CREATE TABLE MONITORES (
    CPF VARCHAR2(14),
    NOME VARCHAR2(20) NOT NULL,
    CONTATO VARCHAR2(13),
    
    CONSTRAINT PK_MON PRIMARY KEY (CPF),
    CONSTRAINT CK_MON_CON CHECK(REGEXP_LIKE(CONTATO, '[0-9]{2}\-[0-9]{5}\-[0-9]{4}')),
    CONSTRAINT CK_MON_CPF CHECK(REGEXP_LIKE(CPF, '[0-9]{3}\.[0-9]{3}\.[0-9]{3}\-[0-9]{2}'))
);

CREATE TABLE ALUGUEL_BRINQUEDO (
    ID INTEGER,
    DATA_HORA DATE NOT NULL,
    LOCAL VARCHAR2(20) NOT NULL,
    NOM_BRINQUEDO VARCHAR2(20) NOT NULL,
    MOD_BRINQUEDO VARCHAR2(10) NOT NULL,
    
    CONSTRAINT PK_AB PRIMARY KEY (ID),
    CONSTRAINT UN_AB UNIQUE (DATA_HORA, LOCAL, NOM_BRINQUEDO, MOD_BRINQUEDO),
    CONSTRAINT FK_AB_DAT FOREIGN KEY (DATA_HORA, LOCAL) REFERENCES FESTAS(DATA_HORA, LOCAL) ON DELETE CASCADE  
); 

CREATE TABLE MONITOR_ALUGUEL_BRINQUEDO (
    MONITOR VARCHAR2(14),
    ALUGUEL_BRINQUEDO INTEGER,
    
    CONSTRAINT PK_MAB PRIMARY KEY (MONITOR, ALUGUEL_BRINQUEDO),
    CONSTRAINT FK_MAB_MON FOREIGN KEY (MONITOR) REFERENCES MONITORES(CPF) ON DELETE CASCADE,
    CONSTRAINT FK_MAB_AB FOREIGN KEY (ALUGUEL_BRINQUEDO) REFERENCES ALUGUEL_BRINQUEDO(ID) ON DELETE CASCADE
); 

CREATE TABLE BRINQUEDOS (
    NOME VARCHAR2(20),
    MODELO VARCHAR2(10),
    VALOR FLOAT,
    CAPACIDADE INTEGER,
    MAX_PESSOAS INTEGER,
    MAX_PESO FLOAT,
    
    CONSTRAINT PK_BRI PRIMARY KEY (NOME, MODELO),
    CONSTRAINT FK_BRI FOREIGN KEY (NOME, MODELO) REFERENCES ALUGUEL_BRINQUEDO (NOM_BRINQUEDO, MOD_BRINQUEDO) ON DELETE CASCADE
);

CREATE TABLE ATRACOES_MUSICAIS (
    NOM_ARTISTICO VARCHAR(20),
    CUSTO FLOAT,
    DURACAO TIMESTAMP,
    ESTILO VARCHAR(20),
    TIPO VARCHAR(5) NOT NULL,
    
    CONSTRAINT PK_AM PRIMARY KEY (NOM_ARTISTICO)
);

CREATE TABLE INTEGRANTES (
    NOME VARCHAR2(20),
    FUNCAO VARCHAR(20),
    CONTATO VARCHAR2(13) NOT NULL,
    BANDA VARCHAR(20),
    
    CONSTRAINT PK_INT PRIMARY KEY (NOME),
    CONSTRAINT FK_INT_BAN FOREIGN KEY (BANDA) REFERENCES ATRACOES_MUSICAIS(NOM_ARTISTICO) ON DELETE CASCADE
    CONSTRAINT CK_INT_CON CHECK(REGEXP_LIKE(CONTATO, '[0-9]{2}\-[0-9]{5}\-[0-9]{4}')),
);

CREATE TABLE APRESENTACOES (
    ID INTEGER,
    DATA_HORA_FESTA DATE NOT NULL,
    LOCAL_FESTA VARCHAR2(20) NOT NULL,
    NOM_ARTISTICO VARCHAR2(20) NOT NULL,
    HORARIO DATE,
    
    CONSTRAINT PK_APR PRIMARY KEY (ID),
    CONSTRAINT UN_APR UNIQUE (DATA_HORA_FESTA, LOCAL_FESTA, NOM_ARTISTICO),
    CONSTRAINT FK_APR_NA FOREIGN KEY (NOM_ARTISTICO) REFERENCES ATRACOES_MUSICAIS(NOM_ARTISTICO) ON DELETE CASCADE
);

CREATE TABLE APRESENTACOES_EQUIPAMENTOS (
    APRESENTACAO INTEGER,
    TIP_EQUIP VARCHAR2(20),
    MOD_EQUIP VARCHAR2(20),
    
    CONSTRAINT PK_AE PRIMARY KEY (APRESENTACAO, TIP_EQUIP, MOD_EQUIP),
    CONSTRAINT FK_AE_APR FOREIGN KEY (APRESENTACAO) REFERENCES APRESENTACOES (ID) ON DELETE CASCADE
);

CREATE TABLE EQUIPAMENTOS (
    TIPO VARCHAR(20),
    MODELO VARCHAR(20),
    QUANTIDADE INTEGER,
    
    CONSTRAINT PK_EQUI PRIMARY KEY (TIPO, MODELO),
    CONSTRAINT FK_EQUI_TM FOREIGN KEY (TIPO, MODELO) REFERENCES APRESENTACOES_EQUIPAMENTOS (TIP_EQUIP, MOD_EQUIP) ON DELETE CASCADE
);